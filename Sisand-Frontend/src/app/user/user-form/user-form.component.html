<div class="container mt-4">
    <div class="card shadow">
        <div class="card-header bg-primary text-white">
            <h2 class="mb-0">{{ isEditMode ? 'Editar Usuário' : 'Novo Usuário' }}</h2>
        </div>
        <div class="card-body">

            <div *ngIf="successMessage" class="alert alert-success" role="alert">
                {{ successMessage }}
            </div>
            <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
                {{ errorMessage }}
            </div>

            <form [formGroup]="userForm" (ngSubmit)="onSubmit()">

                <div class="mb-3">
                    <label for="username" class="form-label">Nome de Usuário <span class="text-danger">*</span></label>
                    <input type="text" id="username" formControlName="username" class="form-control"
                        [ngClass]="{'is-invalid': f['username'].invalid && f['username'].touched}">
                    <div *ngIf="f['username'].invalid && f['username'].touched" class="invalid-feedback">
                        O nome de usuário é obrigatório.
                    </div>
                </div>

                <div class="mb-3">
                    <label for="email" class="form-label">Email <span class="text-danger">*</span></label>
                    <input type="email" id="email" formControlName="email" class="form-control"
                        [ngClass]="{'is-invalid': f['email'].invalid && f['email'].touched}">
                    <div *ngIf="f['email'].invalid && f['email'].touched" class="invalid-feedback">
                        O email é obrigatório e deve ser válido.
                    </div>
                </div>

                <div class="mb-3" *ngIf="!isEditMode || f['password']">
                    <label for="password" class="form-label">
                        Senha <span *ngIf="!isEditMode" class="text-danger">*</span>
                        <span *ngIf="isEditMode" class="text-muted">(Deixe em branco para não alterar)</span>
                    </label>
                    <input type="password" id="password" formControlName="password" class="form-control"
                        [ngClass]="{'is-invalid': f['password'].invalid && f['password'].touched}">
                    <div *ngIf="f['password'].invalid && f['password'].touched" class="invalid-feedback">
                        A senha é obrigatória e deve ter pelo menos 6 caracteres.
                    </div>
                </div>

                <div class="form-check mb-4">
                    <input class="form-check-input" type="checkbox" id="isAdmin" formControlName="isAdmin">
                    <label class="form-check-label" for="isAdmin">
                        Usuário Administrador
                    </label>
                </div>

                <div class="d-flex justify-content-end">
                    <button type="submit" class="btn btn-success me-2" [disabled]="userForm.invalid">
                        <i class="bi bi-save"></i> {{ isEditMode ? 'Salvar Alterações' : 'Criar Usuário' }}
                    </button>
                    <button type="button" class="btn btn-outline-secondary" (click)="router.navigate(['/users'])">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                </div>

            </form>
        </div>
    </div>
</div>